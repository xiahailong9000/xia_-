<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>打开获取系统文件</TITLE>
<META content="text/html; charset=gb2312" http-equiv=Content-Type>
<META name=GENERATOR content="MSHTML 11.00.9600.17924"><LINK rel=stylesheet 
href="_template.css"></HEAD>
<BODY>
<DIV id=nsbanner>
<DIV id=bannerrow1>
<TABLE class=bannerparthead>
  <TBODY>
  <TR id=hdr>
    <TD class=runninghead noWrap>wwwwww</TD></TR></TBODY></TABLE></DIV>
<DIV id=titlerow>
<H1 class=dtH1>打开获取系统文件</H1></DIV></DIV>
<DIV id=nstext><BR>
<P>using UnityEngine;<BR>using System.Collections;<BR>using System;<BR>using 
System.Runtime.InteropServices;<BR>[StructLayout(LayoutKind.Sequential, CharSet 
= CharSet.Auto)]<BR>public class S_打开系统窗口{<BR>&nbsp;&nbsp;&nbsp; public int 
structSize = 0;<BR>&nbsp;&nbsp;&nbsp; public IntPtr dlgOwner = 
IntPtr.Zero;<BR>&nbsp;&nbsp;&nbsp; public IntPtr instance = 
IntPtr.Zero;<BR>&nbsp;&nbsp;&nbsp; public String filter = 
null;<BR>&nbsp;&nbsp;&nbsp; public String customFilter = 
null;<BR>&nbsp;&nbsp;&nbsp; public int maxCustFilter = 0;<BR>&nbsp;&nbsp;&nbsp; 
public int filterIndex = 0;<BR>&nbsp;&nbsp;&nbsp; public String o_路径 = 
null;<BR>&nbsp;&nbsp;&nbsp; public int maxFile = 0;<BR>&nbsp;&nbsp;&nbsp; public 
String fileTitle = null;<BR>&nbsp;&nbsp;&nbsp; public int maxFileTitle = 
0;<BR>&nbsp;&nbsp;&nbsp; public String initialDir = null;<BR>&nbsp;&nbsp;&nbsp; 
public String title = null;<BR>&nbsp;&nbsp;&nbsp; public int flags = 
0;<BR>&nbsp;&nbsp;&nbsp; public short fileOffset = 0;<BR>&nbsp;&nbsp;&nbsp; 
public short fileExtension = 0;<BR>&nbsp;&nbsp;&nbsp; public String defExt = 
null;<BR>&nbsp;&nbsp;&nbsp; public IntPtr custData = 
IntPtr.Zero;<BR>&nbsp;&nbsp;&nbsp; public IntPtr hook = 
IntPtr.Zero;<BR>&nbsp;&nbsp;&nbsp; public String templateName = 
null;<BR>&nbsp;&nbsp;&nbsp; public IntPtr reservedPtr = 
IntPtr.Zero;<BR>&nbsp;&nbsp;&nbsp; public int reservedInt = 
0;<BR>&nbsp;&nbsp;&nbsp; public int flagsEx = 0;<BR>&nbsp;&nbsp;&nbsp; public 
static string S_Open路径(){<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S_打开系统窗口 
ksk = S_初始化();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
WindowDll.GetOpenFileName(ksk);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
return ksk.o_路径;<BR>&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; public static 
string S_Save路径(){<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S_打开系统窗口 ksk = 
S_初始化();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
WindowDll.GetSaveFileName(ksk);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
return ksk.o_路径;<BR>&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; private static 
S_打开系统窗口 S_初始化() {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S_打开系统窗口 i_kkk 
= new S_打开系统窗口();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i_kkk.structSize 
= Marshal.SizeOf(i_kkk);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
i_kkk.filter = "All 
Files\0*.*\0\0";<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i_kkk.o_路径 = new 
string(new char[256]);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
i_kkk.maxFile = i_kkk.o_路径.Length;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
i_kkk.fileTitle = new string(new 
char[64]);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i_kkk.maxFileTitle = 
i_kkk.fileTitle.Length;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
i_kkk.initialDir = UnityEngine.Application.dataPath;//默认路径&nbsp; 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i_kkk.title = "Open 
Project";<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i_kkk.defExt = 
"xml";//显示文件的类型&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i_kkk.flags 
= 0x00080000 | 0x00001000 | 0x00000800 | 0x00000200 | 
0x00000008;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 
i_kkk;<BR>&nbsp;&nbsp;&nbsp; }<BR>}<BR>public class 
WindowDll{<BR>&nbsp;&nbsp;&nbsp; [DllImport("Comdlg32.dll", SetLastError = true, 
ThrowOnUnmappableChar = true, CharSet = CharSet.Auto)]<BR>&nbsp;&nbsp;&nbsp; 
public static extern bool GetOpenFileName([In, Out] S_打开系统窗口 
ofn);<BR>&nbsp;&nbsp;&nbsp; public static bool GetOpenFileName1([In, Out] 
S_打开系统窗口 ofn){ return GetOpenFileName(ofn); }&nbsp;&nbsp;&nbsp;<BR>&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp; [DllImport("Comdlg32.dll", SetLastError = true, 
ThrowOnUnmappableChar = true, CharSet = CharSet.Auto)]<BR>&nbsp;&nbsp;&nbsp; 
public static extern bool GetSaveFileName([In, Out] S_打开系统窗口 
ofn);<BR>&nbsp;&nbsp;&nbsp; public static bool GetSaveFileName1([In, Out] 
S_打开系统窗口 ofn){ return GetSaveFileName(ofn); }</P>
<P>}</P></DIV>
<DIV class=footer>
<P></P></DIV></BODY></HTML>
